import{_ as $,u as F,l as H,m as f,q as G,s as J,x as X,a as E,y as ee,c,b as e,w as m,j as te,i as se,z as y,F as v,r as M,h as _,t as h,g as N,f as C,o as r,A as ae,B as ne,n as ie,d as oe,e as le,p as ce,k as re}from"./index-01669123.js";const i=u=>(ce("data-v-7833fad7"),u=u(),re(),u),de={class:"product-page container py-4"},_e={class:"d-flex flex-column flex-lg-row gap-4 mb-4"},he={class:"filter-sidebar"},ge={class:"filter-card card shadow-filter"},me=C('<div class="card-header filter-header" data-v-7833fad7><div class="filter-header-content" data-v-7833fad7><i class="bx bx-filter-alt filter-header-icon" data-v-7833fad7></i><h5 class="m-0 fw-bold filter-title" data-v-7833fad7>Bộ lọc sản phẩm</h5></div><p class="filter-subtitle m-0" data-v-7833fad7>Tìm kiếm sản phẩm phù hợp với bạn</p></div>',1),ue={class:"card-body filter-body"},pe={class:"filter-section"},be=i(()=>e("label",{class:"filter-label"},[e("i",{class:"bx bx-search filter-label-icon"}),e("span",null,"Tìm kiếm")],-1)),fe={class:"search-wrapper"},ye=["onKeyup"],ve=i(()=>e("i",{class:"bx bx-search-alt-2"},null,-1)),xe=[ve],we={class:"filter-section"},Ie=i(()=>e("label",{class:"filter-label"},[e("i",{class:"bx bx-category filter-label-icon"}),e("span",null,"Danh mục")],-1)),ke=i(()=>e("option",{value:""},"Tất cả danh mục",-1)),Me=["value"],Ne={class:"filter-section"},Ce=i(()=>e("label",{class:"filter-label"},[e("i",{class:"bx bx-money filter-label-icon"}),e("span",null,"Mức giá")],-1)),Ae=C('<option value="all" data-v-7833fad7>Tất cả mức giá</option><option value="0-500" data-v-7833fad7>Dưới 500.000đ</option><option value="500-1000" data-v-7833fad7>500.000đ - 1.000.000đ</option><option value="1000-3000" data-v-7833fad7>1.000.000đ - 3.000.000đ</option><option value="3000-99999" data-v-7833fad7>Trên 3.000.000đ</option>',5),De=[Ae],Te={class:"filter-section"},Se=i(()=>e("label",{class:"filter-label"},[e("i",{class:"bx bx-check-circle filter-label-icon"}),e("span",null,"Tình trạng")],-1)),je=C('<option value="" data-v-7833fad7>Tất cả tình trạng</option><option value="new" data-v-7833fad7>Mới 100%</option><option value="likenew" data-v-7833fad7>Như mới (99%)</option><option value="good" data-v-7833fad7>Tốt</option><option value="fair" data-v-7833fad7>Khá</option>',5),ze=[je],Be=i(()=>e("i",{class:"bx bx-refresh"},null,-1)),Pe=i(()=>e("span",null,"Đặt lại",-1)),Ge=[Be,Pe],Ee=i(()=>e("i",{class:"bx bx-check"},null,-1)),Qe=i(()=>e("span",null,"Áp dụng",-1)),Le=[Ee,Qe],Oe={class:"flex-grow-1"},We={class:"d-flex flex-column flex-md-row align-items-md-center justify-content-md-between gap-2 mb-4"},Ze=i(()=>e("div",{class:"header-content"},[e("h2",{class:"fw-bold m-0 page-title"},"Danh sách sản phẩm"),e("p",{class:"page-subtitle mb-0"},"Khám phá những món đồ cũ chất lượng được cập nhật mỗi ngày.")],-1)),Re={class:"d-flex flex-wrap align-items-center gap-2"},Ue=i(()=>e("label",{class:"sort-label fw-semibold small m-0"},[e("i",{class:"bx bx-sort me-1"}),_("Sắp xếp: ")],-1)),Ve=i(()=>e("option",{value:"newest"},"Mới nhất",-1)),Ye=i(()=>e("option",{value:"price_asc"},"Giá tăng dần",-1)),qe=i(()=>e("option",{value:"price_desc"},"Giá giảm dần",-1)),Ke=i(()=>e("option",{value:"popular"},"Bán chạy",-1)),$e=[Ve,Ye,qe,Ke],Fe={key:0,class:"row g-3"},He=i(()=>e("div",{class:"skeleton-card"},[e("div",{class:"sk-img"}),e("div",{class:"sk-line w-75"}),e("div",{class:"sk-line w-50"})],-1)),Je=[He],Xe={key:1,class:"alert alert-error"},et=i(()=>e("i",{class:"bx bx-error-circle me-2"},null,-1)),tt=i(()=>e("i",{class:"bx bx-refresh me-1"},null,-1)),st={key:0,class:"empty-state text-center p-5 border rounded-4"},at=i(()=>e("div",{class:"empty-icon"},[e("i",{class:"bx bx-search-alt-2"})],-1)),nt=i(()=>e("h5",{class:"fw-bold empty-title"},"Không tìm thấy sản phẩm phù hợp",-1)),it=i(()=>e("p",{class:"empty-text"},"Thử thay đổi bộ lọc hoặc tìm kiếm từ khóa khác.",-1)),ot=i(()=>e("i",{class:"bx bx-refresh me-1"},null,-1)),lt={key:1,class:"row g-3 g-lg-4 product-grid"},ct={class:"product-card card h-100 shadow-product"},rt={class:"ratio ratio-4x3 product-image-wrapper"},dt=["src","alt"],_t=i(()=>e("div",{class:"image-overlay"},null,-1)),ht={key:0,class:"badge badge-discount"},gt=i(()=>e("i",{class:"bx bx-tag me-1"},null,-1)),mt={class:"card-body d-flex flex-column"},ut=["title"],pt={class:"card-text small mb-2 line-clamp-2"},bt={class:"d-flex align-items-baseline gap-2 mb-3"},ft={key:0,class:"price-old text-decoration-line-through small"},yt={class:"mt-auto d-flex flex-wrap gap-2 product-actions"},vt=i(()=>e("i",{class:"bx bx-show me-1"},null,-1)),xt=["onClick"],wt=i(()=>e("i",{class:"bx bx-cart-add me-1"},null,-1)),It=["onClick"],kt=i(()=>e("i",{class:"bx bx-purchase-tag me-1"},null,-1)),Mt={key:2,class:"pagination-wrap d-flex justify-content-center align-items-center gap-3 mt-5"},Nt=["disabled"],Ct=i(()=>e("i",{class:"bx bx-chevron-left me-1"},null,-1)),At={class:"pagination-info"},Dt={class:"pagination-current"},Tt=i(()=>e("span",{class:"pagination-separator"},"/",-1)),St={class:"pagination-total"},jt=["disabled"],zt=i(()=>e("i",{class:"bx bx-chevron-right ms-1"},null,-1)),Q="fe_marketplace_cart",Bt={__name:"index",setup(u){const A=F(),L=H(),D="/api/client",O=`${D}/san-pham`,W=`${D}/danh-muc`,g=f([]),x=f([]),w=f(!1),p=f("");function Z(){return"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgdmlld0JveD0iMCAwIDQwMCAzMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI0MDAiIGhlaWdodD0iMzAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yMDAgMTIwQzIxNS40NjQgMTIwIDIyOCAxMDcuNDY0IDIyOCA5MkMyMjggNzYuNTM2IDIxNS40NjQgNjQgMjAwIDY0QzE4NC41MzYgNjQgMTcyIDc2LjUzNiAxNzIgOTJDMTcyIDEwNy40NjQgMTg0LjUzNiAxMjAgMjAwIDEyMFoiIGZpbGw9IiM5Q0EzQUYiLz4KPHBhdGggZD0iTTIwMCAxODBDMTcwIDE4MCAxNDQgMTk2IDEzMCAyMjBIMjcwQzI1NiAxOTYgMjMwIDE4MCAyMDAgMTgwWiIgZmlsbD0iIzlDQTNBRiIvPgo8dGV4dCB4PSIyMDAiIHk9IjI1MCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmaWxsPSIjOUNBM0FGIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj5ObyBJbWFnZTwvdGV4dD4KPC9zdmc+"}const I=Z(),l=G({current_page:1,last_page:1,total:0,per_page:12}),o=G({keyword:"",category:"",price:"all",condition:"",sort:"newest"});function T(){const t=A.query;t.category&&(o.category=t.category),t.q&&(o.keyword=t.q),t.sort&&(o.sort=t.sort),t.page&&(l.current_page=parseInt(t.page)||1)}J(()=>{T(),R()}),X(()=>A.query,()=>{T(),d()},{deep:!0});async function R(){await Promise.allSettled([U(),d()])}async function U(){try{const{data:t}=await E.get(W),a=(t==null?void 0:t.data)||t||[];x.value=Array.isArray(a)?a.map(n=>({id:n.id,name:n.ten_danh_muc||n.name,slug:n.slug,mo_ta:n.mo_ta,hinh_anh:n.hinh_anh})):[]}catch(t){console.warn("Không thể tải danh mục",t),x.value=[]}}function V(){const t={page:l.current_page,sort:o.sort};if(o.keyword&&(t.q=o.keyword),o.category&&(t.category=o.category),o.condition&&(t.condition=o.condition),o.price&&o.price!=="all"){const[a,n]=o.price.split("-").map(Number);t.price_min=a*1e3,n&&n<99999&&(t.price_max=n*1e3)}return t}async function d(){var t,a;w.value=!0,p.value="";try{const{data:n}=await E.get(O,{params:V()}),s=(n==null?void 0:n.data)||n;s!=null&&s.data?(g.value=s.data,l.current_page=Number(s.current_page||1),l.last_page=Number(s.last_page||1),l.total=Number(s.total||s.data.length),l.per_page=Number(s.per_page||l.per_page)):Array.isArray(s)?(g.value=s,l.current_page=1,l.last_page=1,l.total=s.length):g.value=[]}catch(n){console.error(n),p.value=((a=(t=n==null?void 0:n.response)==null?void 0:t.data)==null?void 0:a.message)||"Không thể tải danh sách sản phẩm."}finally{w.value=!1}}function S(){o.keyword="",o.category="",o.price="all",o.condition="",o.sort="newest",l.current_page=1,d()}function j(t){t<1||t>l.last_page||(l.current_page=t,d(),window.scrollTo({top:0,behavior:"smooth"}))}function z(t){const a=Number((t==null?void 0:t.price)||0),n=Number((t==null?void 0:t.discount)||0);return a*(1-n/100)}function B(t){return(Number(t)||0).toLocaleString("vi-VN")+" ₫"}function P(t){if(t!=null&&t.image)return t.image;if(Array.isArray(t==null?void 0:t.images)&&t.images.length>0)return t.images[0];if(t!=null&&t.hinh_anh)try{const a=typeof t.hinh_anh=="string"&&t.hinh_anh.trim().startsWith("[")?JSON.parse(t.hinh_anh):t.hinh_anh;if(Array.isArray(a)&&a.length>0)return a[0];if(typeof a=="string"&&a)return a}catch{if(typeof t.hinh_anh=="string"&&t.hinh_anh)return t.hinh_anh}return null}function Y(t){if(t.target.dataset.fallbackSet==="true"){t.target.style.display="none";return}t.target.dataset.fallbackSet="true",t.target.src=I,t.target.onerror=null}function q(t){const a=localStorage.getItem(Q),n=a?JSON.parse(a):[],s=Array.isArray(n)?n.findIndex(b=>b.id===t.id):-1;s>-1?n[s].quantity=Math.min(99,Number(n[s].quantity||0)+1):n.push({id:t.id,name:t.name,price:Number(z(t)),quantity:1,image:P(t)||I,category:t.category||""}),localStorage.setItem(Q,JSON.stringify(n)),window.dispatchEvent(new CustomEvent("cart-updated")),typeof window<"u"&&(window!=null&&window.$toast)?window.$toast.success("Đã thêm vào giỏ hàng!"):alert("Đã thêm vào giỏ hàng!")}function K(t){t!=null&&t.id&&L.push({name:"checkout",query:{product_id:t.id}})}return(t,a)=>{const n=ee("router-link");return r(),c("div",de,[e("section",_e,[e("aside",he,[e("div",ge,[me,e("div",ue,[e("div",pe,[be,e("div",fe,[m(e("input",{"onUpdate:modelValue":a[0]||(a[0]=s=>o.keyword=s),type:"search",class:"form-control search-input",placeholder:"Nhập từ khóa, thương hiệu...",onKeyup:se(d,["enter"])},null,40,ye),[[te,o.keyword]]),e("button",{class:"btn btn-search",type:"button",onClick:d,title:"Tìm kiếm"},xe)])]),e("div",we,[Ie,m(e("select",{"onUpdate:modelValue":a[1]||(a[1]=s=>o.category=s),class:"form-select filter-select",onChange:d},[ke,(r(!0),c(v,null,M(x.value,s=>(r(),c("option",{key:s.slug||s.id,value:s.slug||s.id},h(s.name||s.ten_danh_muc),9,Me))),128))],544),[[y,o.category]])]),e("div",Ne,[Ce,m(e("select",{"onUpdate:modelValue":a[2]||(a[2]=s=>o.price=s),class:"form-select filter-select",onChange:d},De,544),[[y,o.price]])]),e("div",Te,[Se,m(e("select",{"onUpdate:modelValue":a[3]||(a[3]=s=>o.condition=s),class:"form-select filter-select",onChange:d},ze,544),[[y,o.condition]])]),e("div",{class:"filter-actions"},[e("button",{class:"btn btn-reset",type:"button",onClick:S},Ge),e("button",{class:"btn btn-apply",type:"button",onClick:d},Le)])])])]),e("section",Oe,[e("header",We,[Ze,e("div",Re,[Ue,m(e("select",{"onUpdate:modelValue":a[4]||(a[4]=s=>o.sort=s),class:"form-select form-select-sm sort-select",style:{width:"200px"},onChange:d},$e,544),[[y,o.sort]])])]),w.value?(r(),c("div",Fe,[(r(),c(v,null,M(8,s=>e("div",{key:s,class:"col-6 col-md-4 col-lg-3"},Je)),64))])):p.value?(r(),c("div",Xe,[et,_(h(p.value)+" ",1),e("button",{type:"button",class:"btn btn-sm btn-error-retry ms-2",onClick:d},[tt,_("Thử lại ")])])):(r(),c(v,{key:2},[g.value.length===0?(r(),c("div",st,[at,nt,it,e("button",{class:"btn btn-empty-reset",type:"button",onClick:S},[ot,_("Xóa bộ lọc ")])])):(r(),c("div",lt,[(r(!0),c(v,null,M(g.value,(s,b)=>(r(),c("article",{key:s.id,class:"col-12 col-sm-6 col-lg-4 col-xl-3 product-item",style:ae({animationDelay:`${b*.05}s`})},[e("div",ct,[e("div",rt,[e("img",{src:P(s)||ne(I),class:"card-img-top product-image",alt:s.name,onError:a[5]||(a[5]=k=>Y(k))},null,40,dt),_t,s.discount?(r(),c("span",ht,[gt,_("-"+h(s.discount)+"% ",1)])):N("",!0)]),e("div",mt,[e("h6",{class:"card-title product-name text-truncate",title:s.name},h(s.name),9,ut),e("p",pt,h(s.description),1),e("div",bt,[e("span",{class:ie(["price price-current",b%2===0?"price-red":"price-orange"])},h(B(z(s))),3),s.discount?(r(),c("span",ft,h(B(s.price)),1)):N("",!0)]),e("div",yt,[oe(n,{to:`/san-pham/${s.id}`,class:"btn btn-detail btn-sm flex-grow-1"},{default:le(()=>[vt,_("Chi tiết ")]),_:2},1032,["to"]),e("button",{class:"btn btn-cart btn-sm flex-grow-1",type:"button",onClick:k=>q(s)},[wt,_("Giỏ hàng ")],8,xt),e("button",{class:"btn btn-buy btn-sm flex-grow-1",type:"button",onClick:k=>K(s)},[kt,_("Mua ngay ")],8,It)])])])],4))),128))])),l.last_page>1?(r(),c("nav",Mt,[e("button",{class:"btn btn-pagination btn-prev",type:"button",disabled:l.current_page===1,onClick:a[6]||(a[6]=s=>j(l.current_page-1))},[Ct,_("Trước ")],8,Nt),e("span",At,[e("span",Dt,h(l.current_page),1),Tt,e("span",St,h(l.last_page),1)]),e("button",{class:"btn btn-pagination btn-next",type:"button",disabled:l.current_page===l.last_page,onClick:a[7]||(a[7]=s=>j(l.current_page+1))},[_(" Sau"),zt],8,jt)])):N("",!0)],64))])])])}}},Gt=$(Bt,[["__scopeId","data-v-7833fad7"]]);export{Gt as default};
