import{_ as O,m as r,q as F,s as Q,a as m,c,b as t,w as u,j as b,i as R,F as z,r as J,g as C,E as W,t as l,H as V,h as B,o as d,p as Y,k as Z}from"./index-01669123.js";const i=p=>(Y("data-v-b6b62c4e"),p=p(),Z(),p),tt={class:"container py-4"},st={class:"d-flex justify-content-between align-items-center mb-3"},et=i(()=>t("h3",null,"Quản lý tài khoản người dùng",-1)),at={class:"input-group w-50"},ot=["onKeyup"],nt={class:"table-responsive"},lt={class:"table table-hover align-middle"},it=i(()=>t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"#"),t("th",null,"Họ và tên"),t("th",null,"Email"),t("th",null,"SĐT"),t("th",null,"CCCD"),t("th",null,"Ngày sinh"),t("th",null,"Active"),t("th",null,"Blocked"),t("th",null,"Hành động")])],-1)),ct={key:0,class:"badge bg-success"},dt={key:1,class:"badge bg-secondary"},ht={key:0,class:"badge bg-danger"},_t={key:1,class:"badge bg-success"},rt=["onClick"],ut=["onClick"],mt=["onClick"],bt=["onClick"],vt={key:0},pt=i(()=>t("td",{colspan:"9",class:"text-center"},"Không có dữ liệu",-1)),yt=[pt],gt={class:"modal-dialog"},ft={class:"modal-content"},kt=["onSubmit"],Ct={class:"modal-header"},wt={class:"modal-title"},xt={class:"modal-body"},Tt={class:"mb-2"},Et=i(()=>t("label",{class:"form-label"},"Họ và tên",-1)),Mt={class:"mb-2"},At=i(()=>t("label",{class:"form-label"},"Email",-1)),Dt={class:"mb-2"},It=i(()=>t("label",{class:"form-label"},"Số điện thoại",-1)),St={class:"mb-2"},Ut=i(()=>t("label",{class:"form-label"},"CCCD",-1)),Vt={class:"mb-2"},Bt=i(()=>t("label",{class:"form-label"},"Ngày sinh",-1)),Ht={key:0,class:"form-check form-switch mt-2"},Lt=i(()=>t("label",{class:"form-check-label"},"Blocked",-1)),Nt={key:1,class:"form-check form-switch mt-2"},Pt=i(()=>t("label",{class:"form-check-label"},"Active",-1)),Kt={key:2,class:"mb-2"},jt=i(()=>t("small",{class:"text-muted"},'Mật khẩu mặc định khi thêm: "123456" (theo backend của bạn). Nếu bạn muốn đặt khác, hãy chỉnh backend hoặc mở thêm input mật khẩu.',-1)),qt=[jt],Xt={class:"modal-footer"},$t={type:"submit",class:"btn btn-primary"},Gt={class:"modal-dialog modal-sm"},Ot={class:"modal-content"},Ft={class:"modal-body"},Qt={"aria-live":"polite",class:"position-relative"},Rt={class:"toast-container position-fixed bottom-0 end-0 p-3"},zt=i(()=>t("div",{class:"toast-header"},[t("strong",{class:"me-auto"},"Thông báo"),t("small",null,"now"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"toast"})],-1)),Jt={class:"toast-body"},Wt="/api/khach-hang/getData",Yt="/api/khach-hang/addData",Zt="/api/khach-hang/update",ts="/api/khach-hang/destroy",ss="/api/khach-hang/changeStatus",es="/api/khach-hang/changeActive",as="/api/khach-hang/search",os={__name:"index",setup(p){const v=r([]),y=r(""),h=r(!1),o=F({id:null,ho_va_ten:"",email:"",so_dien_thoai:"",password:"",cccd:"",ngay_sinh:"",is_block:0,is_active:0}),g=r(null),E=r(""),M=r(null),A=r(null),w=r(null);let f=null,x=null,D=null;Q(()=>{f=new bootstrap.Modal(M.value),x=new bootstrap.Modal(A.value),D=new bootstrap.Toast(w.value),_()});function n(s){E.value=s,w.value.querySelector(".toast-body").innerText=s,D.show()}function H(s){return s?s.slice(0,10):""}async function _(){try{const s=await m.get(Wt);s.data&&s.data.data?v.value=s.data.data:v.value=s.data||[]}catch(s){console.error(s),n("Lấy dữ liệu thất bại")}}function L(){y.value="",_()}async function I(){try{const s=await m.post(as,{noi_dung:y.value});s.data&&s.data.data&&(v.value=s.data.data)}catch(s){console.error(s),n("Tìm kiếm lỗi")}}function N(){h.value=!1,Object.assign(o,{id:null,ho_va_ten:"",email:"",so_dien_thoai:"",password:"",cccd:"",ngay_sinh:"",is_block:0,is_active:0}),f.show()}function P(s){h.value=!0,Object.assign(o,{id:s.id,ho_va_ten:s.ho_va_ten,email:s.email,so_dien_thoai:s.so_dien_thoai,password:s.password||"",cccd:s.cccd,ngay_sinh:s.ngay_sinh?s.ngay_sinh.slice(0,10):"",is_block:s.is_block?1:0,is_active:s.is_active?1:0}),f.show()}function k(){f.hide()}function K(s){g.value=s,x.show()}function S(){g.value=null,x.hide()}async function j(){try{const s=await m.post(ts,{id:g.value.id});s.data&&s.data.status?(n(s.data.message||"Xóa thành công"),_()):n(s.data.message||"Xóa thất bại")}catch(s){console.error(s),n("Lỗi khi xóa")}finally{S()}}async function q(){try{if(h.value){const s={...o},e=await m.post(Zt,s);e.data&&e.data.status?(n(e.data.message||"Cập nhật thành công"),_(),k()):n(e.data.message||"Cập nhật thất bại")}else{const s={ho_va_ten:o.ho_va_ten,email:o.email,so_dien_thoai:o.so_dien_thoai,cccd:o.cccd,ngay_sinh:o.ngay_sinh},e=await m.post(Yt,s);e.data&&e.data.status?(n(e.data.message||"Thêm thành công"),_(),k()):n(e.data.message||"Thêm thất bại")}}catch(s){console.error(s),n("Lỗi khi lưu dữ liệu")}}async function X(s){try{const e=await m.post(ss,{id:s.id});e.data&&e.data.status?(n(e.data.message||"Thay đổi trạng thái block thành công"),_()):n(e.data.message||"Thao tác thất bại")}catch(e){console.error(e),n("Lỗi thay đổi trạng thái")}}async function $(s){try{const e=await m.post(es,{id:s.id});e.data&&e.data.status?(n(e.data.message||"Thay đổi trạng thái active thành công"),_()):n(e.data.message||"Thao tác thất bại")}catch(e){console.error(e),n("Lỗi thay đổi trạng thái")}}return(s,e)=>{var U;return d(),c("div",tt,[t("div",st,[et,t("div",at,[u(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>y.value=a),onKeyup:R(I,["enter"]),type:"text",class:"form-control",placeholder:"Tìm theo tên, email, sđt..."},null,40,ot),[[b,y.value]]),t("button",{class:"btn btn-outline-secondary",onClick:I},"Tìm"),t("button",{class:"btn btn-outline-secondary",onClick:L},"Reset")])]),t("div",{class:"mb-3"},[t("button",{class:"btn btn-primary",onClick:N},"Thêm tài khoản"),t("button",{class:"btn btn-secondary ms-2",onClick:_},"Làm mới")]),t("div",nt,[t("table",lt,[it,t("tbody",null,[(d(!0),c(z,null,J(v.value,(a,G)=>(d(),c("tr",{key:a.id},[t("td",null,l(G+1),1),t("td",null,l(a.ho_va_ten),1),t("td",null,l(a.email),1),t("td",null,l(a.so_dien_thoai),1),t("td",null,l(a.cccd),1),t("td",null,l(H(a.ngay_sinh)),1),t("td",null,[a.is_active?(d(),c("span",ct,"Active")):(d(),c("span",dt,"Inactive"))]),t("td",null,[a.is_block?(d(),c("span",ht,"Blocked")):(d(),c("span",_t,"Normal"))]),t("td",null,[t("button",{class:"btn btn-sm btn-info me-1",onClick:T=>P(a)},"Sửa",8,rt),t("button",{class:"btn btn-sm btn-danger me-1",onClick:T=>K(a)},"Xóa",8,ut),t("button",{class:"btn btn-sm btn-warning me-1",onClick:T=>X(a)},l(a.is_block?"Bỏ block":"Block"),9,mt),t("button",{class:"btn btn-sm btn-outline-primary",onClick:T=>$(a)},l(a.is_active?"Vô hiệu":"Kích hoạt"),9,bt)])]))),128)),v.value.length===0?(d(),c("tr",vt,yt)):C("",!0)])])]),t("div",{class:"modal fade",id:"userModal",tabindex:"-1","aria-hidden":"true",ref_key:"userModalEl",ref:M},[t("div",gt,[t("div",ft,[t("form",{onSubmit:W(q,["prevent"])},[t("div",Ct,[t("h5",wt,l(h.value?"Cập nhật tài khoản":"Thêm tài khoản mới"),1),t("button",{type:"button",class:"btn-close",onClick:k})]),t("div",xt,[t("div",Tt,[Et,u(t("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>o.ho_va_ten=a),type:"text",class:"form-control",required:""},null,512),[[b,o.ho_va_ten]])]),t("div",Mt,[At,u(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>o.email=a),type:"email",class:"form-control",required:""},null,512),[[b,o.email]])]),t("div",Dt,[It,u(t("input",{"onUpdate:modelValue":e[3]||(e[3]=a=>o.so_dien_thoai=a),type:"text",class:"form-control"},null,512),[[b,o.so_dien_thoai]])]),t("div",St,[Ut,u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>o.cccd=a),type:"text",class:"form-control"},null,512),[[b,o.cccd]])]),t("div",Vt,[Bt,u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=a=>o.ngay_sinh=a),type:"date",class:"form-control"},null,512),[[b,o.ngay_sinh]])]),h.value?(d(),c("div",Ht,[u(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=a=>o.is_block=a)},null,512),[[V,o.is_block]]),Lt])):C("",!0),h.value?(d(),c("div",Nt,[u(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=a=>o.is_active=a)},null,512),[[V,o.is_active]]),Pt])):C("",!0),h.value?C("",!0):(d(),c("div",Kt,qt))]),t("div",Xt,[t("button",{type:"button",class:"btn btn-secondary",onClick:k},"Hủy"),t("button",$t,l(h.value?"Cập nhật":"Thêm"),1)])],40,kt)])])],512),t("div",{class:"modal fade",id:"confirmDeleteModal",tabindex:"-1",ref_key:"confirmDeleteModalEl",ref:A},[t("div",Gt,[t("div",Ot,[t("div",Ft,[t("p",null,[B("Bạn có chắc chắn muốn xóa "),t("strong",null,l((U=g.value)==null?void 0:U.ho_va_ten),1),B(" ?")]),t("div",{class:"d-flex justify-content-end"},[t("button",{class:"btn btn-secondary me-2",onClick:S},"Hủy"),t("button",{class:"btn btn-danger",onClick:j},"Xóa")])])])])],512),t("div",Qt,[t("div",Rt,[t("div",{class:"toast",ref_key:"toastEl",ref:w,role:"alert","aria-live":"assertive","aria-atomic":"true"},[zt,t("div",Jt,l(E.value),1)],512)])])])}}},ls=O(os,[["__scopeId","data-v-b6b62c4e"]]);export{ls as default};
