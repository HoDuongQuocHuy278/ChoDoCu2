import{_ as Y,q as J,m as g,s as Z,a as v,c as d,b as t,h as _,w as k,j as tt,i as st,z as P,t as a,F as C,r as A,g as H,o as u,n as et,p as nt,k as ot,f as at}from"./index-01669123.js";const n=y=>(nt("data-v-5ca32722"),y=y(),ot(),y),lt={class:"orders-page container py-4"},ct=n(()=>t("div",null,[t("h2",{class:"fw-bold m-0"},"Qu·∫£n l√Ω ƒë∆°n h√†ng"),t("p",{class:"text-muted mb-0"},"Theo d√µi tr·∫°ng th√°i, x·ª≠ l√Ω thanh to√°n v√† xu·∫•t h√≥a ƒë∆°n cho kh√°ch h√†ng.")],-1)),it=n(()=>t("i",{class:"bx bx-refresh me-1"},null,-1)),dt=n(()=>t("i",{class:"bx bx-download me-1"},null,-1)),ut={class:"card shadow-sm"},ht={class:"card-body"},_t={class:"row g-3 mb-3"},mt={class:"col-lg-4 col-md-6"},rt=n(()=>t("label",{class:"form-label text-muted small mb-1"},"T√¨m ki·∫øm",-1)),pt={class:"input-group"},bt=["onKeyup"],gt=n(()=>t("i",{class:"bx bx-search"},null,-1)),vt=[gt],yt={class:"col-lg-3 col-md-6"},ft=n(()=>t("label",{class:"form-label text-muted small mb-1"},"Tr·∫°ng th√°i ƒë∆°n",-1)),xt=at('<option value="" data-v-5ca32722>T·∫•t c·∫£</option><option value="pending" data-v-5ca32722>Ch·ªù x·ª≠ l√Ω</option><option value="processing" data-v-5ca32722>ƒêang giao</option><option value="completed" data-v-5ca32722>Ho√†n th√†nh</option><option value="cancelled" data-v-5ca32722>ƒê√£ h·ªßy</option>',5),wt=[xt],kt={class:"col-lg-3 col-md-6"},Ct=n(()=>t("label",{class:"form-label text-muted small mb-1"},"Thanh to√°n",-1)),Tt=n(()=>t("option",{value:""},"T·∫•t c·∫£",-1)),St=n(()=>t("option",{value:"unpaid"},"Ch∆∞a thanh to√°n",-1)),Pt=n(()=>t("option",{value:"paid"},"ƒê√£ thanh to√°n",-1)),At=n(()=>t("option",{value:"refunded"},"Ho√†n ti·ªÅn",-1)),It=[Tt,St,Pt,At],Kt={key:0,class:"text-center py-5"},Mt=n(()=>t("div",{class:"spinner-border text-success",role:"status"},[t("span",{class:"visually-hidden"},"ƒêang t·∫£i...")],-1)),Nt=[Mt],Vt={key:1,class:"alert alert-danger d-flex justify-content-between align-items-center"},Et={key:0,class:"empty-state text-center p-5 border border-dashed rounded-4"},Lt=n(()=>t("div",{class:"emoji mb-2"},"üßæ",-1)),Ut=n(()=>t("h5",{class:"fw-semibold"},"Ch∆∞a c√≥ ƒë∆°n h√†ng n√†o",-1)),Dt=n(()=>t("p",{class:"text-muted mb-0"},"C√°c ƒë∆°n m·ªõi s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y khi kh√°ch h√†ng ƒë·∫∑t mua.",-1)),$t=[Lt,Ut,Dt],Ht={key:1,class:"table-responsive"},jt={class:"table align-middle"},Bt=n(()=>t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"M√£ ƒë∆°n"),t("th",null,"Kh√°ch h√†ng"),t("th",null,"S·∫£n ph·∫©m"),t("th",null,"T·ªïng ti·ªÅn"),t("th",null,"Thanh to√°n"),t("th",null,"Tr·∫°ng th√°i"),t("th",null,"Ng√†y ƒë·∫∑t"),t("th",{class:"text-end"},"Thao t√°c")])],-1)),Ot={class:"fw-semibold"},Rt={class:"text-muted"},qt={class:"fw-semibold"},Xt={class:"text-muted"},Ft={class:"list-unstyled small mb-0"},zt={key:0,class:"text-muted"},Gt={class:"fw-semibold text-success"},Qt=["onUpdate:modelValue","onChange"],Wt=n(()=>t("option",{value:"pending"},"Ch·ªù x·ª≠ l√Ω",-1)),Yt=n(()=>t("option",{value:"processing"},"ƒêang giao",-1)),Jt=n(()=>t("option",{value:"completed"},"Ho√†n th√†nh",-1)),Zt=n(()=>t("option",{value:"cancelled"},"ƒê√£ h·ªßy",-1)),ts=[Wt,Yt,Jt,Zt],ss={class:"text-end"},es={class:"btn-group"},ns=["onClick"],os=["onClick","disabled"],as=["onClick","disabled"],ls={class:"modal-dialog modal-lg modal-dialog-scrollable"},cs={class:"modal-content"},is={class:"modal-header"},ds={class:"modal-title"},us={key:0,class:"modal-body"},hs={class:"mb-3"},_s=n(()=>t("h6",{class:"fw-semibold"},"Th√¥ng tin kh√°ch h√†ng",-1)),ms={class:"mb-1"},rs=n(()=>t("strong",null,"H·ªç t√™n:",-1)),ps={class:"mb-1"},bs=n(()=>t("strong",null,"Email:",-1)),gs={class:"mb-1"},vs=n(()=>t("strong",null,"S·ªë ƒëi·ªán tho·∫°i:",-1)),ys={class:"mb-1"},fs=n(()=>t("strong",null,"ƒê·ªãa ch·ªâ:",-1)),xs={class:"mb-3"},ws=n(()=>t("h6",{class:"fw-semibold"},"Danh s√°ch s·∫£n ph·∫©m",-1)),ks={class:"table table-sm align-middle"},Cs=n(()=>t("thead",{class:"table-light"},[t("tr",null,[t("th",null,"S·∫£n ph·∫©m"),t("th",null,"S·ªë l∆∞·ª£ng"),t("th",null,"ƒê∆°n gi√°"),t("th",null,"T·ªïng")])],-1)),Ts={class:"row"},Ss={class:"col-md-6"},Ps=n(()=>t("h6",{class:"fw-semibold"},"Thanh to√°n",-1)),As={class:"mb-1"},Is=n(()=>t("strong",null,"Ph∆∞∆°ng th·ª©c:",-1)),Ks={class:"mb-1"},Ms=n(()=>t("strong",null,"Tr·∫°ng th√°i:",-1)),Ns={class:"col-md-6 text-md-end"},Vs=n(()=>t("h6",{class:"fw-semibold"},"T·ªïng c·ªông",-1)),Es={class:"mb-1"},Ls=n(()=>t("strong",null,"T·∫°m t√≠nh:",-1)),Us={class:"mb-1"},Ds=n(()=>t("strong",null,"Ph√≠ ship:",-1)),$s={class:"mb-1"},Hs=n(()=>t("strong",null,"Gi·∫£m gi√°:",-1)),js={class:"mb-0 fs-5 fw-bold text-success"},Bs="http://127.0.0.1:8000/api/admin/orders",Os="http://127.0.0.1:8000/api/admin/orders/export",Rs={__name:"index",setup(y){const j=s=>`http://127.0.0.1:8000/api/admin/orders/${s}/status`,B=s=>`http://127.0.0.1:8000/api/admin/orders/${s}/payment`,O=s=>`http://127.0.0.1:8000/api/admin/orders/${s}/cancel`,h=J({keyword:"",status:"",payment_status:""}),f=g([]),T=g(!1),x=g(""),S=g(null),w=g(null),c=g(null);Z(()=>{I(),p()});function I(){typeof bootstrap<"u"&&S.value&&(w.value=new bootstrap.Modal(S.value))}async function p(){var s,l;T.value=!0,x.value="";try{const{data:o}=await v.get(Bs,{params:{...h}});f.value=(o==null?void 0:o.data)||o||[]}catch(o){console.error(o),x.value=((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message)||"Kh√¥ng th·ªÉ t·∫£i danh s√°ch ƒë∆°n h√†ng.",f.value=[]}finally{T.value=!1}}function R(){h.keyword="",h.status="",h.payment_status="",p()}async function q(s){var l,o;try{await v.post(j(s.id),{status:s.status})}catch(i){alert(((o=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:o.message)||i.message||"Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t tr·∫°ng th√°i.")}}async function X(s){var l,o;try{await v.post(B(s.id),{status:"paid"}),s.payment_status="paid"}catch(i){alert(((o=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:o.message)||i.message||"Kh√¥ng th·ªÉ c·∫≠p nh·∫≠t thanh to√°n.")}}async function F(s){var l,o;if(confirm(`X√°c nh·∫≠n h·ªßy ƒë∆°n #${s.code||s.id}?`))try{await v.post(O(s.id)),s.status="cancelled"}catch(i){alert(((o=(l=i==null?void 0:i.response)==null?void 0:l.data)==null?void 0:o.message)||i.message||"Kh√¥ng th·ªÉ h·ªßy ƒë∆°n h√†ng.")}}function z(s){var l;c.value=s,w.value||I(),(l=w.value)==null||l.show()}function K(){var s;(s=w.value)==null||s.hide(),c.value=null}async function G(){var s,l;try{const o=await v.get(Os,{params:{...h},responseType:"blob"}),i=window.URL.createObjectURL(new Blob([o.data])),m=document.createElement("a");m.href=i,m.setAttribute("download","orders.xlsx"),document.body.appendChild(m),m.click(),m.parentNode.removeChild(m)}catch(o){alert(((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message)||o.message||"Kh√¥ng th·ªÉ xu·∫•t file.")}}function b(s){return(Number(s)||0).toLocaleString("vi-VN")+" ‚Ç´"}function Q(s){if(!s)return"‚Äî";try{return new Date(s).toLocaleString("vi-VN")}catch{return s}}function W(s){switch(s){case"paid":return"bg-success-subtle text-success";case"refunded":return"bg-warning-subtle text-warning";default:return"bg-secondary-subtle text-secondary"}}function M(s){switch(s){case"paid":return"ƒê√£ thanh to√°n";case"refunded":return"Ho√†n ti·ªÅn";case"unpaid":default:return"Ch∆∞a thanh to√°n"}}return(s,l)=>{var o,i,m,N,V,E;return u(),d("div",lt,[t("header",{class:"d-flex flex-column flex-lg-row align-items-lg-center justify-content-lg-between gap-3 mb-4"},[ct,t("div",{class:"d-flex flex-wrap gap-2"},[t("button",{class:"btn btn-outline-secondary",type:"button",onClick:p},[it,_(" L√†m m·ªõi ")]),t("button",{class:"btn btn-success",type:"button",onClick:G},[dt,_(" Xu·∫•t Excel ")])])]),t("section",ut,[t("div",ht,[t("div",_t,[t("div",mt,[rt,t("div",pt,[k(t("input",{"onUpdate:modelValue":l[0]||(l[0]=e=>h.keyword=e),type:"search",class:"form-control",placeholder:"M√£ ƒë∆°n, email...",onKeyup:st(p,["enter"])},null,40,bt),[[tt,h.keyword,void 0,{trim:!0}]]),t("button",{class:"btn btn-outline-secondary",type:"button",onClick:p},vt)])]),t("div",yt,[ft,k(t("select",{"onUpdate:modelValue":l[1]||(l[1]=e=>h.status=e),class:"form-select",onChange:p},wt,544),[[P,h.status]])]),t("div",kt,[Ct,k(t("select",{"onUpdate:modelValue":l[2]||(l[2]=e=>h.payment_status=e),class:"form-select",onChange:p},It,544),[[P,h.payment_status]])]),t("div",{class:"col-lg-2 col-md-6 d-grid"},[t("button",{class:"btn btn-outline-secondary",type:"button",onClick:R},"ƒê·∫∑t l·∫°i")])]),T.value?(u(),d("div",Kt,Nt)):x.value?(u(),d("div",Vt,[t("span",null,a(x.value),1),t("button",{class:"btn btn-sm btn-light",type:"button",onClick:p},"Th·ª≠ l·∫°i")])):(u(),d(C,{key:2},[f.value.length===0?(u(),d("div",Et,$t)):(u(),d("div",Ht,[t("table",jt,[Bt,t("tbody",null,[(u(!0),d(C,null,A(f.value,e=>{var L,U,D,$;return u(),d("tr",{key:e.id},[t("td",null,[t("div",Ot,"#"+a(e.code||e.id),1),t("small",Rt,"K√™nh: "+a(e.channel||"Website"),1)]),t("td",null,[t("div",qt,a(((L=e.customer)==null?void 0:L.name)||e.customer_name||"Kh√°ch l·∫ª"),1),t("small",Xt,a(((U=e.customer)==null?void 0:U.email)||e.customer_email),1)]),t("td",null,[t("ul",Ft,[(u(!0),d(C,null,A(((D=e.items)==null?void 0:D.slice(0,2))||[],r=>(u(),d("li",{key:r.id}," ‚Ä¢ "+a(r.name)+" √ó "+a(r.quantity),1))),128))]),((($=e.items)==null?void 0:$.length)||0)>2?(u(),d("small",zt,"+"+a(e.items.length-2)+" s·∫£n ph·∫©m kh√°c",1)):H("",!0)]),t("td",Gt,a(b(e.total_amount)),1),t("td",null,[t("span",{class:et(["badge",W(e.payment_status)])},a(M(e.payment_status)),3)]),t("td",null,[k(t("select",{"onUpdate:modelValue":r=>e.status=r,class:"form-select form-select-sm",onChange:r=>q(e)},ts,40,Qt),[[P,e.status]])]),t("td",null,a(Q(e.created_at)),1),t("td",ss,[t("div",es,[t("button",{class:"btn btn-sm btn-outline-primary",type:"button",onClick:r=>z(e)},"Chi ti·∫øt",8,ns),t("button",{class:"btn btn-sm btn-outline-success",type:"button",onClick:r=>X(e),disabled:e.payment_status==="paid"}," X√°c nh·∫≠n TT ",8,os),t("button",{class:"btn btn-sm btn-outline-danger",type:"button",onClick:r=>F(e),disabled:e.status==="cancelled"}," H·ªßy ƒë∆°n ",8,as)])])])}),128))])])]))],64))])]),t("div",{class:"modal fade",tabindex:"-1",ref_key:"detailModalRef",ref:S},[t("div",ls,[t("div",cs,[t("div",is,[t("h5",ds,"Chi ti·∫øt ƒë∆°n #"+a(((o=c.value)==null?void 0:o.code)||((i=c.value)==null?void 0:i.id)),1),t("button",{type:"button",class:"btn-close",onClick:K})]),c.value?(u(),d("div",us,[t("div",hs,[_s,t("p",ms,[rs,_(" "+a(((m=c.value.customer)==null?void 0:m.name)||c.value.customer_name),1)]),t("p",ps,[bs,_(" "+a(((N=c.value.customer)==null?void 0:N.email)||c.value.customer_email),1)]),t("p",gs,[vs,_(" "+a(((V=c.value.customer)==null?void 0:V.phone)||c.value.customer_phone||"‚Äî"),1)]),t("p",ys,[fs,_(" "+a(((E=c.value.customer)==null?void 0:E.address)||c.value.shipping_address||"‚Äî"),1)])]),t("div",xs,[ws,t("table",ks,[Cs,t("tbody",null,[(u(!0),d(C,null,A(c.value.items||[],e=>(u(),d("tr",{key:e.id},[t("td",null,a(e.name),1),t("td",null,a(e.quantity),1),t("td",null,a(b(e.price)),1),t("td",null,a(b(e.price*e.quantity)),1)]))),128))])])]),t("div",Ts,[t("div",Ss,[Ps,t("p",As,[Is,_(" "+a(c.value.payment_method||"Ti·ªÅn m·∫∑t"),1)]),t("p",Ks,[Ms,_(" "+a(M(c.value.payment_status)),1)])]),t("div",Ns,[Vs,t("p",Es,[Ls,_(" "+a(b(c.value.subtotal||c.value.total_amount)),1)]),t("p",Us,[Ds,_(" "+a(b(c.value.shipping_fee||0)),1)]),t("p",$s,[Hs,_(" -"+a(b(c.value.discount||0)),1)]),t("p",js,"Th√†nh ti·ªÅn: "+a(b(c.value.total_amount)),1)])])])):H("",!0),t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary",onClick:K},"ƒê√≥ng")])])])],512)])}}},Xs=Y(Rs,[["__scopeId","data-v-5ca32722"]]);export{Xs as default};
