import{_ as w,a as b,c,b as e,t as n,w as g,j as S,z as p,F as y,r as f,E as I,n as v,g as _,h as u,o as r,p as M,k as D}from"./index-01669123.js";const T={name:"SalesHistory",data(){return{isLoading:!1,salesHistory:[],summary:{total_revenue:0,total_orders:0,completed_revenue:0,average_order_value:0},selectedSale:null,searchText:"",sortBy:"date_desc",filterStatus:"all",filterReview:"all",fallbackImg:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjQwMCIgdmlld0JveD0iMCAwIDYwMCA0MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSI2MDAiIGhlaWdodD0iNDAwIiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0zMDAgMTYwQzM0NS4yMjkgMTYwIDM4MiAxMjMuMjI5IDM4MiA3OEMzODIgMzIuNzcwOSAzNDUuMjI5IDYgMzAwIDZDMjU0Ljc3MCA2IDIxOCAzMi43NzA5IDIxOCA3OEMyMTggMTIzLjIyOSAyNTQuNzcwIDE2MCAzMDAgMTYwWiIgZmlsbD0iIzlDQTNBRiIvPgo8cGF0aCBkPSJNMzAwIDI0MEMyNTAgMjQwIDIxMCAyNTYgMTg1IDI4MEg0MTVDMzkwIDI1NiAzNTAgMjQwIDMwMCAyNDBaIiBmaWxsPSIjOUNBM0FGIi8+Cjx0ZXh0IHg9IjMwMCIgeT0iMzIwIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTgiIGZpbGw9IiM5Q0EzQUYiIHRleHQtYW5jaG9yPSJtaWRkbGUiPk5vIEltYWdlPC90ZXh0Pgo8L3N2Zz4=",API_BASE_URL:"/api/client"}},computed:{filteredSalesHistory(){let i=[...this.salesHistory];if(this.searchText.trim()){const s=this.searchText.toLowerCase();i=i.filter(d=>d.buyer_name.toLowerCase().includes(s)||d.product_name.toLowerCase().includes(s)||d.order_code.toLowerCase().includes(s)||d.buyer_email&&d.buyer_email.toLowerCase().includes(s)||d.buyer_phone&&d.buyer_phone.includes(s))}return this.filterStatus!=="all"&&(i=i.filter(s=>this.filterStatus==="paid"?s.payment_status==="paid":this.filterStatus==="pending"?s.payment_status==="pending":this.filterStatus==="completed"?s.order_status==="completed":!0)),this.filterReview!=="all"&&(this.filterReview==="with_review"?i=i.filter(s=>s.review!==null):this.filterReview==="no_review"&&(i=i.filter(s=>s.review===null))),i.sort((s,d)=>this.sortBy==="date_desc"?new Date(d.order_date)-new Date(s.order_date):this.sortBy==="date_asc"?new Date(s.order_date)-new Date(d.order_date):this.sortBy==="amount_desc"?d.total_amount-s.total_amount:this.sortBy==="amount_asc"?s.total_amount-d.total_amount:0),i}},mounted(){this.fetchSalesHistory()},methods:{getCurrentUser(){try{if(!localStorage.getItem("key_client"))return null;const s=localStorage.getItem("user_info");if(s)return JSON.parse(s)}catch(i){console.warn("KhÃ´ng thá»ƒ láº¥y thÃ´ng tin ngÆ°á»i dÃ¹ng",i)}return null},async fetchSalesHistory(){var s,d;const i=this.getCurrentUser();if(!(i!=null&&i.id)){this.salesHistory=[],this.isLoading=!1;return}this.isLoading=!0;try{const m=localStorage.getItem("key_client"),t=await b.get(`${this.API_BASE_URL}/seller/sales-history`,{headers:{Authorization:`Bearer ${m}`}});(s=t==null?void 0:t.data)!=null&&s.status&&((d=t==null?void 0:t.data)!=null&&d.data)&&(this.salesHistory=t.data.data.sales_history||[],this.summary=t.data.data.summary||{})}catch(m){console.error("Error fetching sales history:",m),this.$toast?this.$toast.error("KhÃ´ng thá»ƒ táº£i lá»‹ch sá»­ bÃ¡n hÃ ng"):alert("KhÃ´ng thá»ƒ táº£i lá»‹ch sá»­ bÃ¡n hÃ ng"),this.salesHistory=[]}finally{this.isLoading=!1}},viewDetail(i){this.selectedSale=i},closeDetail(){this.selectedSale=null},getStatusClass(i){return{paid:"status-paid",completed:"status-completed",pending:"status-pending",awaiting_payment:"status-pending"}[i]||"status-default"},getStatusLabel(i){return{paid:"ÄÃ£ thanh toÃ¡n",completed:"HoÃ n thÃ nh",pending:"Chá» thanh toÃ¡n",awaiting_payment:"Chá» thanh toÃ¡n"}[i]||i},getPaymentMethodLabel(i){return{vnpay:"VNPay",momo:"MoMo",cash:"Tiá»n máº·t"}[i]||i},formatPrice(i){return(Number(i)||0).toLocaleString("vi-VN")+" â‚«"},formatDate(i){return i?new Date(i).toLocaleDateString("vi-VN"):""},formatTime(i){return i?new Date(i).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"}):""},formatDateTime(i){return i?new Date(i).toLocaleString("vi-VN"):""},onImgError(i){i.target.src=this.fallbackImg}}},l=i=>(M("data-v-9d1eafde"),i=i(),D(),i),C={class:"sales-history-container"},k={class:"header-section"},N=l(()=>e("h1",{class:"page-title"},"ğŸ“Š Lá»ŠCH Sá»¬ BÃN HÃ€NG",-1)),x={class:"summary-cards"},A={class:"summary-card revenue"},L=l(()=>e("div",{class:"card-icon"},"ğŸ’°",-1)),H={class:"card-content"},B=l(()=>e("div",{class:"card-label"},"Tá»•ng Doanh Thu",-1)),P={class:"card-value"},z={class:"summary-card orders"},j=l(()=>e("div",{class:"card-icon"},"ğŸ“¦",-1)),E={class:"card-content"},G=l(()=>e("div",{class:"card-label"},"Tá»•ng ÄÆ¡n HÃ ng",-1)),R={class:"card-value"},Z={class:"summary-card completed"},U=l(()=>e("div",{class:"card-icon"},"âœ…",-1)),V={class:"card-content"},W=l(()=>e("div",{class:"card-label"},"Doanh Thu ÄÃ£ Thanh ToÃ¡n",-1)),Q={class:"card-value"},Y={class:"summary-card average"},O=l(()=>e("div",{class:"card-icon"},"ğŸ“ˆ",-1)),J={class:"card-content"},X=l(()=>e("div",{class:"card-label"},"GiÃ¡ Trá»‹ ÄÆ¡n Trung BÃ¬nh",-1)),F={class:"card-value"},q={class:"filters-section"},K={class:"filter-group"},$=l(()=>e("label",null,"ğŸ” TÃ¬m kiáº¿m:",-1)),ee={class:"filter-group"},te=l(()=>e("label",null,"ğŸ“… Sáº¯p xáº¿p:",-1)),se=l(()=>e("option",{value:"date_desc"},"Má»›i nháº¥t",-1)),ie=l(()=>e("option",{value:"date_asc"},"CÅ© nháº¥t",-1)),le=l(()=>e("option",{value:"amount_desc"},"GiÃ¡ cao â†’ tháº¥p",-1)),oe=l(()=>e("option",{value:"amount_asc"},"GiÃ¡ tháº¥p â†’ cao",-1)),ne=[se,ie,le,oe],ae={class:"filter-group"},ce=l(()=>e("label",null,"ğŸ” Tráº¡ng thÃ¡i:",-1)),re=l(()=>e("option",{value:"all"},"Táº¥t cáº£",-1)),de=l(()=>e("option",{value:"paid"},"ÄÃ£ thanh toÃ¡n",-1)),_e=l(()=>e("option",{value:"pending"},"Chá» thanh toÃ¡n",-1)),he=l(()=>e("option",{value:"completed"},"HoÃ n thÃ nh",-1)),ue=[re,de,_e,he],me={class:"filter-group"},ge=l(()=>e("label",null,"â­ CÃ³ Ä‘Ã¡nh giÃ¡:",-1)),ve=l(()=>e("option",{value:"all"},"Táº¥t cáº£",-1)),pe=l(()=>e("option",{value:"with_review"},"CÃ³ Ä‘Ã¡nh giÃ¡",-1)),ye=l(()=>e("option",{value:"no_review"},"ChÆ°a Ä‘Ã¡nh giÃ¡",-1)),fe=[ve,pe,ye],we={key:0,class:"loading-section"},be=l(()=>e("div",{class:"loading-spinner"},null,-1)),Se=l(()=>e("p",null,"Äang táº£i lá»‹ch sá»­ bÃ¡n hÃ ng...",-1)),Ie=[be,Se],Me={key:1,class:"empty-state"},De=l(()=>e("div",{class:"empty-icon"},"ğŸ“­",-1)),Te={key:0},Ce={key:1},ke={key:2,class:"table-container"},Ne={class:"sales-table"},xe=l(()=>e("thead",null,[e("tr",null,[e("th",null,"Thá»i gian"),e("th",null,"MÃ£ Ä‘Æ¡n"),e("th",null,"NgÆ°á»i mua"),e("th",null,"Sáº£n pháº©m"),e("th",null,"Sá»‘ lÆ°á»£ng"),e("th",null,"ÄÆ¡n giÃ¡"),e("th",null,"Tá»•ng tiá»n"),e("th",null,"Tráº¡ng thÃ¡i"),e("th",null,"ÄÃ¡nh giÃ¡"),e("th",{class:"text-center"},"Thao tÃ¡c")])],-1)),Ae={class:"date-cell"},Le={class:"date-text"},He={class:"time-text"},Be={class:"code-cell"},Pe={class:"buyer-cell"},ze={class:"buyer-info"},je={class:"buyer-name"},Ee={key:0,class:"buyer-detail"},Ge={key:1,class:"buyer-detail"},Re={key:2,class:"buyer-detail"},Ze={class:"product-cell"},Ue={class:"product-info"},Ve=["src","alt"],We={class:"product-details"},Qe={class:"product-name"},Ye={class:"product-id"},Oe={class:"quantity-cell text-center"},Je={class:"price-cell"},Xe={class:"total-cell"},Fe={class:"status-cell"},qe={class:"review-cell"},Ke={key:0,class:"review-badge"},$e={class:"review-rating"},et={class:"review-comment"},tt={class:"review-date"},st={key:1,class:"no-review"},it={class:"actions-cell text-center"},lt=["onClick"],ot={class:"modal-box"},nt=l(()=>e("h2",null,"Chi tiáº¿t Ä‘Æ¡n hÃ ng",-1)),at={class:"detail-section"},ct=l(()=>e("h3",null,"ğŸ“‹ ThÃ´ng tin Ä‘Æ¡n hÃ ng",-1)),rt={class:"detail-grid"},dt={class:"detail-item"},_t=l(()=>e("label",null,"MÃ£ Ä‘Æ¡n:",-1)),ht={class:"detail-item"},ut=l(()=>e("label",null,"NgÃ y Ä‘áº·t:",-1)),mt={class:"detail-item"},gt=l(()=>e("label",null,"Tráº¡ng thÃ¡i:",-1)),vt={class:"detail-item"},pt=l(()=>e("label",null,"PhÆ°Æ¡ng thá»©c thanh toÃ¡n:",-1)),yt={class:"detail-section"},ft=l(()=>e("h3",null,"ğŸ‘¤ ThÃ´ng tin ngÆ°á»i mua",-1)),wt={class:"detail-grid"},bt={class:"detail-item"},St=l(()=>e("label",null,"Há» tÃªn:",-1)),It={key:0,class:"detail-item"},Mt=l(()=>e("label",null,"Sá»‘ Ä‘iá»‡n thoáº¡i:",-1)),Dt={key:1,class:"detail-item"},Tt=l(()=>e("label",null,"Email:",-1)),Ct={key:2,class:"detail-item"},kt=l(()=>e("label",null,"Äá»‹a chá»‰:",-1)),Nt={class:"detail-section"},xt=l(()=>e("h3",null,"ğŸ“¦ ThÃ´ng tin sáº£n pháº©m",-1)),At={class:"product-detail-card"},Lt=["src","alt"],Ht={class:"product-detail-info"},Bt={class:"total-price"},Pt={key:0,class:"detail-section"},zt=l(()=>e("h3",null,"â­ ÄÃ¡nh giÃ¡",-1)),jt={class:"review-detail"},Et={class:"review-rating"},Gt={class:"rating-text"},Rt={class:"review-comment-text"},Zt={class:"reviewer-info"},Ut={key:1,class:"detail-section"},Vt=l(()=>e("h3",null,"â­ ÄÃ¡nh giÃ¡",-1)),Wt=l(()=>e("p",{class:"no-review-text"},"ChÆ°a cÃ³ Ä‘Ã¡nh giÃ¡",-1)),Qt=[Vt,Wt];function Yt(i,s,d,m,t,a){return r(),c("div",C,[e("div",k,[N,e("div",x,[e("div",A,[L,e("div",H,[B,e("div",P,n(a.formatPrice(t.summary.total_revenue||0)),1)])]),e("div",z,[j,e("div",E,[G,e("div",R,n(t.summary.total_orders||0),1)])]),e("div",Z,[U,e("div",V,[W,e("div",Q,n(a.formatPrice(t.summary.completed_revenue||0)),1)])]),e("div",Y,[O,e("div",J,[X,e("div",F,n(a.formatPrice(t.summary.average_order_value||0)),1)])])])]),e("div",q,[e("div",K,[$,g(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.searchText=o),type:"text",placeholder:"TÃ¬m theo tÃªn ngÆ°á»i mua, sáº£n pháº©m, mÃ£ Ä‘Æ¡n...",class:"search-input"},null,512),[[S,t.searchText]])]),e("div",ee,[te,g(e("select",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.sortBy=o),class:"select-input"},ne,512),[[p,t.sortBy]])]),e("div",ae,[ce,g(e("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.filterStatus=o),class:"select-input"},ue,512),[[p,t.filterStatus]])]),e("div",me,[ge,g(e("select",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.filterReview=o),class:"select-input"},fe,512),[[p,t.filterReview]])])]),t.isLoading?(r(),c("div",we,Ie)):a.filteredSalesHistory.length?(r(),c("div",ke,[e("table",Ne,[xe,e("tbody",null,[(r(!0),c(y,null,f(a.filteredSalesHistory,o=>(r(),c("tr",{key:o.order_id,class:"table-row"},[e("td",Ae,[e("div",Le,n(a.formatDate(o.order_date)),1),e("small",He,n(a.formatTime(o.order_date)),1)]),e("td",Be,[e("strong",null,n(o.order_code),1)]),e("td",Pe,[e("div",ze,[e("div",je,n(o.buyer_name),1),o.buyer_phone?(r(),c("div",Ee,"ğŸ“ "+n(o.buyer_phone),1)):_("",!0),o.buyer_email?(r(),c("div",Ge,"âœ‰ï¸ "+n(o.buyer_email),1)):_("",!0),o.buyer_address?(r(),c("div",Re,"ğŸ“ "+n(o.buyer_address),1)):_("",!0)])]),e("td",Ze,[e("div",Ue,[e("img",{src:o.product_image||t.fallbackImg,alt:o.product_name,class:"product-thumb",onError:s[4]||(s[4]=h=>a.onImgError(h))},null,40,Ve),e("div",We,[e("div",Qe,n(o.product_name),1),e("small",Ye,"ID: "+n(o.product_id),1)])])]),e("td",Oe,[e("strong",null,n(o.quantity),1)]),e("td",Je,n(a.formatPrice(o.product_price)),1),e("td",Xe,[e("strong",null,n(a.formatPrice(o.total_amount)),1)]),e("td",Fe,[e("span",{class:v(["status-badge",a.getStatusClass(o.payment_status)])},n(a.getStatusLabel(o.payment_status)),3)]),e("td",qe,[o.review?(r(),c("div",Ke,[e("div",$e,[(r(),c(y,null,f(5,h=>e("span",{key:h,class:v(["star",{active:h<=o.review.rating}])}," â˜… ",2)),64))]),e("div",et,n(o.review.comment),1),e("small",tt,n(a.formatDate(o.review.reviewed_at)),1)])):(r(),c("span",st,"ChÆ°a Ä‘Ã¡nh giÃ¡"))]),e("td",it,[e("button",{class:"btn-view-detail",onClick:h=>a.viewDetail(o),title:"Xem chi tiáº¿t"}," ğŸ‘ï¸ ",8,lt)])]))),128))])])])):(r(),c("div",Me,[De,a.getCurrentUser()?(r(),c("p",Ce,"ğŸ˜¿ Báº¡n chÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o.")):(r(),c("p",Te,"âš ï¸ Vui lÃ²ng Ä‘Äƒng nháº­p Ä‘á»ƒ xem lá»‹ch sá»­ bÃ¡n hÃ ng."))])),t.selectedSale?(r(),c("div",{key:3,class:"modal-overlay",onClick:s[7]||(s[7]=I((...o)=>a.closeDetail&&a.closeDetail(...o),["self"]))},[e("div",ot,[e("button",{class:"close-btn",onClick:s[5]||(s[5]=(...o)=>a.closeDetail&&a.closeDetail(...o))},"âœ–"),nt,e("div",at,[ct,e("div",rt,[e("div",dt,[_t,e("span",null,n(t.selectedSale.order_code),1)]),e("div",ht,[ut,e("span",null,n(a.formatDateTime(t.selectedSale.order_date)),1)]),e("div",mt,[gt,e("span",{class:v(["status-badge",a.getStatusClass(t.selectedSale.payment_status)])},n(a.getStatusLabel(t.selectedSale.payment_status)),3)]),e("div",vt,[pt,e("span",null,n(a.getPaymentMethodLabel(t.selectedSale.payment_method)),1)])])]),e("div",yt,[ft,e("div",wt,[e("div",bt,[St,e("span",null,n(t.selectedSale.buyer_name),1)]),t.selectedSale.buyer_phone?(r(),c("div",It,[Mt,e("span",null,n(t.selectedSale.buyer_phone),1)])):_("",!0),t.selectedSale.buyer_email?(r(),c("div",Dt,[Tt,e("span",null,n(t.selectedSale.buyer_email),1)])):_("",!0),t.selectedSale.buyer_address?(r(),c("div",Ct,[kt,e("span",null,n(t.selectedSale.buyer_address),1)])):_("",!0)])]),e("div",Nt,[xt,e("div",At,[e("img",{src:t.selectedSale.product_image||t.fallbackImg,alt:t.selectedSale.product_name,class:"product-detail-img",onError:s[6]||(s[6]=o=>a.onImgError(o))},null,40,Lt),e("div",Ht,[e("h4",null,n(t.selectedSale.product_name),1),e("p",null,[u("Sá»‘ lÆ°á»£ng: "),e("strong",null,n(t.selectedSale.quantity),1)]),e("p",null,[u("ÄÆ¡n giÃ¡: "),e("strong",null,n(a.formatPrice(t.selectedSale.product_price)),1)]),e("p",Bt,[u("Tá»•ng tiá»n: "),e("strong",null,n(a.formatPrice(t.selectedSale.total_amount)),1)])])])]),t.selectedSale.review?(r(),c("div",Pt,[zt,e("div",jt,[e("div",Et,[(r(),c(y,null,f(5,o=>e("span",{key:o,class:v(["star",{active:o<=t.selectedSale.review.rating}])}," â˜… ",2)),64)),e("span",Gt,n(t.selectedSale.review.rating)+"/5",1)]),e("p",Rt,n(t.selectedSale.review.comment),1),e("small",Zt,[u(" ÄÃ¡nh giÃ¡ bá»Ÿi: "),e("strong",null,n(t.selectedSale.review.reviewer_name),1),u(" - "+n(a.formatDateTime(t.selectedSale.review.reviewed_at)),1)])])])):(r(),c("div",Ut,Qt))])])):_("",!0)])}const Jt=w(T,[["render",Yt],["__scopeId","data-v-9d1eafde"]]);export{Jt as default};
