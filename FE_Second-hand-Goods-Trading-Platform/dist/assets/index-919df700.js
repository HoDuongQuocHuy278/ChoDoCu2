import{_ as ot,l as lt,m,q as Q,C as b,s as ct,y as at,c as d,b as t,t as u,g as Z,d as q,e as A,F as it,r as ut,w as dt,j as rt,n as F,o as r,h as V,p as ht,k as _t}from"./index-01669123.js";const a=C=>(ht("data-v-2c500b57"),C=C(),_t(),C),mt={class:"cart-page container py-4"},pt={class:"d-flex flex-column flex-md-row align-items-md-center justify-content-md-between gap-2 mb-4"},gt=a(()=>t("h2",{class:"fw-bold m-0"},"Giá» hÃ ng cá»§a báº¡n",-1)),bt=a(()=>t("p",{class:"text-muted mb-1"},"Quáº£n lÃ½ cÃ¡c sáº£n pháº©m Ä‘Ã£ thÃªm trÆ°á»›c khi tiáº¿n hÃ nh thanh toÃ¡n.",-1)),vt={key:0,class:"text-muted small mb-0"},ft={class:"d-flex gap-2"},yt=["disabled"],It=["disabled"],xt={key:0,class:"alert alert-danger d-flex align-items-center justify-content-between gap-3"},kt=["disabled"],Ct={key:1,class:"loading-state text-center py-5"},wt=a(()=>t("div",{class:"spinner-border text-success mb-3",role:"status","aria-hidden":"true"},null,-1)),Mt=a(()=>t("h4",{class:"fw-semibold"},"Äang táº£i giá» hÃ ng...",-1)),St=a(()=>t("p",{class:"text-muted mb-0"},"Vui lÃ²ng chá» trong giÃ¢y lÃ¡t.",-1)),Nt=[wt,Mt,St],Tt={key:2,class:"empty-state text-center py-5"},Et=a(()=>t("div",{class:"empty-icon mb-3"},"ðŸ›’",-1)),Gt=a(()=>t("h4",{class:"fw-semibold"},"Giá» hÃ ng Ä‘ang trá»‘ng",-1)),Dt=a(()=>t("p",{class:"text-muted mb-4"},"Báº¯t Ä‘áº§u khÃ¡m phÃ¡ Ä‘á»ƒ tÃ¬m nhá»¯ng mÃ³n Ä‘á»“ phÃ¹ há»£p vá»›i báº¡n.",-1)),Rt={key:3,class:"row g-4"},Zt={class:"col-lg-8"},qt={class:"card shadow-sm h-100"},At={class:"card-body p-0"},Vt={class:"table-responsive"},Ht={class:"table align-middle mb-0"},jt={class:"table-light"},Pt={scope:"col",class:"text-center select-col"},Bt=["checked"],Lt=a(()=>t("th",{scope:"col"},"Sáº£n pháº©m",-1)),Qt=a(()=>t("th",{scope:"col",class:"text-center"},"GiÃ¡",-1)),Ft=a(()=>t("th",{scope:"col",class:"text-center qty-col"},"Sá»‘ lÆ°á»£ng",-1)),Ut=a(()=>t("th",{scope:"col",class:"text-center"},"Tá»•ng",-1)),Wt=a(()=>t("th",{scope:"col"},null,-1)),Ot={class:"text-center select-col"},Xt=["checked","onChange"],zt={class:"d-flex align-items-center gap-3"},Jt=["src","onError"],Yt={class:"flex-grow-1"},Kt={class:"mb-1 product-title"},$t={class:"text-muted small mb-0"},te={class:"text-center"},ee={class:"text-center"},se={class:"qty-control mx-auto"},ne=["onClick","disabled"],oe=["value","onInput","disabled"],le=["onClick","disabled"],ce={class:"text-center fw-semibold"},ae={class:"text-end action-cell"},ie=["onClick","disabled"],ue={class:"col-lg-4"},de={class:"card shadow-sm sticky-top",style:{top:"90px"}},re={class:"card-body"},he=a(()=>t("h5",{class:"fw-semibold mb-3"},"TÃ³m táº¯t Ä‘Æ¡n hÃ ng",-1)),_e={class:"d-flex justify-content-between mb-2"},me=a(()=>t("span",null,"Táº¡m tÃ­nh",-1)),pe={class:"fw-semibold"},ge={class:"d-flex justify-content-between mb-2"},be=a(()=>t("span",null,"PhÃ­ váº­n chuyá»ƒn",-1)),ve={class:"d-flex justify-content-between mb-3"},fe=a(()=>t("span",null,"Giáº£m giÃ¡",-1)),ye={class:"border-top pt-3 d-flex justify-content-between align-items-center"},Ie=a(()=>t("span",{class:"fw-bold"},"ThÃ nh tiá»n",-1)),xe={class:"fw-bold fs-5 text-success"},ke={class:"mt-3"},Ce=a(()=>t("label",{class:"form-label"},"MÃ£ giáº£m giÃ¡",-1)),we={class:"input-group"},Me={class:"mt-4 d-grid gap-2"},Se=["disabled"],H="fe_marketplace_cart",N="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiByeD0iMjQiIGZpbGw9IiNGRkZGRkYiIHN0cm9rZT0iI0VCRUVGMyIgc3Ryb2tlLXdpZHRoPSIyIi8+CjxwYXRoIGQ9Ik02MCA4MEg2NEw4MCAxMDZMMTAwIDc0TDEyMCAxMDRMMTQ0IDc0TDE2MCA5OUwxNjQgOTRMMTgwIDExMEgxODQiIHN0cm9rZT0iI0Q5REVERCIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbGluZWNhcD0icm91bmQiIGZpbGw9Im5vbmUiLz4KPHBhdGggZD0iTTQ0IDE0MEgxNTYiIHN0cm9rZT0iI0Q5REVERCIgc3Ryb2tlLXdpZHRoPSIyLjUiIGZpbGw9Im5vbmUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8dGV4dCB4PSI1MCIgeT0iMTYwIiBmaWxsPSIjOURBMEJFIiBmb250LXNpemU9IjE1IiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiPkNoa+G6oW4gY8awIGnhu4duPC90ZXh0Pgo8L3N2Zz4=",Ne={__name:"index",setup(C){const j=lt(),l=m([]),x=m(!1),v=m(!1),f=m(""),w=m(""),h=m(""),p=m(!1),_=Q({code:null,discount:0}),c=Q({subtotal:null,shipping_fee:null,discount_amount:null,total:null}),g=m(!0),k=b(()=>l.value.filter(e=>e.selected)),U=b(()=>k.value.length>0),W=b(()=>k.value.length);ct(()=>{T()});function T(){x.value=!0,f.value="";try{const e=localStorage.getItem(H);if(e){const s=JSON.parse(e);l.value=Array.isArray(s)?s.map(O):[]}else l.value=[];g.value=l.value.length>0,M(),y()}catch(e){console.error("KhÃ´ng thá»ƒ táº£i giá» hÃ ng",e),l.value=[],f.value="KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u giá» hÃ ng.",M(),P()}finally{x.value=!1}}function y(){const e=k.value;c.subtotal=e.reduce((s,o)=>s+G(o),0),c.shipping_fee=0,c.discount_amount=_.discount,c.total=c.subtotal+c.shipping_fee-c.discount_amount}function E(){try{const e=l.value.map(({selected:s,...o})=>o);localStorage.setItem(H,JSON.stringify(e)),y(),window.dispatchEvent(new CustomEvent("cart-updated"))}catch(e){console.error("KhÃ´ng thá»ƒ lÆ°u giá» hÃ ng",e),f.value="KhÃ´ng thá»ƒ lÆ°u giá» hÃ ng."}}function P(){c.subtotal=null,c.shipping_fee=null,c.discount_amount=null,c.total=null}function M(){w.value="",h.value="",p.value=!1,_.code=null,_.discount=0}function O(e){return{id:e.id,name:e.name||"Sáº£n pháº©m chÆ°a Ä‘áº·t tÃªn",price:Number(e.price)||0,quantity:Math.max(1,Number(e.quantity)||1),category:e.category||"",image:e.image||N,line_total:null}}function G(e){return Number.isFinite(e.line_total)?e.line_total:e.price*e.quantity}const S=b(()=>Number.isFinite(c.subtotal)?c.subtotal:k.value.reduce((e,s)=>e+G(s),0)),D=b(()=>Number.isFinite(c.shipping_fee)?c.shipping_fee:0),B=b(()=>Number.isFinite(c.discount_amount)?c.discount_amount:_.discount),X=b(()=>Number.isFinite(c.total)?c.total:S.value+D.value-B.value);function L(e,s){const o=Math.max(1,e.quantity+s);o!==e.quantity&&(e.quantity=o,E())}function z(e,s){const o=parseInt(s,10);!Number.isFinite(o)||o<1?e.quantity=1:e.quantity=Math.min(o,99),E()}function J(e){if(!(e!=null&&e.id))return;const s=l.value.findIndex(o=>o.id===e.id);s>-1&&(l.value.splice(s,1),E(),l.value.length===0&&M(),g.value=l.value.length>0&&l.value.every(o=>o.selected))}function Y(){l.value.length!==0&&confirm("Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n xÃ³a toÃ n bá»™ giá» hÃ ng?")&&(l.value=[],localStorage.removeItem(H),M(),P(),f.value="",g.value=!1)}function K(){const e=w.value.trim().toUpperCase();if(!e){h.value="Vui lÃ²ng nháº­p mÃ£ khuyáº¿n máº¡i.",p.value=!1;return}const s={FREESHIP:{discount:0,message:"Miá»…n phÃ­ váº­n chuyá»ƒn (Ã¡p dá»¥ng khi cÃ³ sáº£n pháº©m)"},DISCOUNT10:{discount:S.value*.1,message:"Giáº£m 10% cho Ä‘Æ¡n hÃ ng"},DISCOUNT20:{discount:S.value*.2,message:"Giáº£m 20% cho Ä‘Æ¡n hÃ ng"}};s[e]?(_.code=e,_.discount=s[e].discount,p.value=!0,h.value=s[e].message,y()):(p.value=!1,h.value="MÃ£ khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ háº¿t háº¡n.",_.code=null,_.discount=0,y())}function I(e){return(Number(e)||0).toLocaleString("vi-VN")+" â‚«"}function $(){if(l.value.length===0){h.value="Giá» hÃ ng Ä‘ang trá»‘ng, hÃ£y thÃªm sáº£n pháº©m trÆ°á»›c.",p.value=!1;return}const e=k.value;if(!e.length){h.value="Vui lÃ²ng chá»n Ã­t nháº¥t má»™t sáº£n pháº©m Ä‘á»ƒ thanh toÃ¡n.",p.value=!1;return}if(e.length===1){j.push({name:"checkout",query:{product_id:e[0].id,quantity:e[0].quantity,from_cart:"1"}});return}const s=e.map(({id:o,name:n,price:i,quantity:R,image:nt})=>({id:o,name:n,price:i,quantity:R,image:nt}));localStorage.setItem("cart_selected_items",JSON.stringify(s)),j.push({name:"checkout",query:{cart_mode:"1",from_cart:"1"}})}function tt(e,s){if(e.target.dataset.fallbackSet==="true"){e.target.style.display="none";return}e.target.dataset.fallbackSet="true",e.target.src=N,s&&(s.image=N),e.target.onerror=null}function et(e){var o;const s=((o=e==null?void 0:e.target)==null?void 0:o.checked)??g.value;g.value=s,l.value.forEach(n=>{n.selected=s}),y()}function st(e,s){var i;const o=((i=s==null?void 0:s.target)==null?void 0:i.checked)??!e.selected;e.selected=o;const n=l.value.length;g.value=n>0&&l.value.every(R=>R.selected),y()}return(e,s)=>{const o=at("router-link");return r(),d("div",mt,[t("header",pt,[t("div",null,[gt,bt,l.value.length?(r(),d("p",vt," ÄÃ£ chá»n "+u(W.value)+" / "+u(l.value.length)+" sáº£n pháº©m ",1)):Z("",!0)]),t("div",ft,[t("button",{class:"btn btn-outline-secondary",type:"button",onClick:T,disabled:x.value||v.value}," Táº£i láº¡i dá»¯ liá»‡u ",8,yt),t("button",{class:"btn btn-outline-danger",type:"button",onClick:Y,disabled:l.value.length===0||v.value}," XÃ³a giá» hÃ ng ",8,It)])]),f.value?(r(),d("div",xt,[t("span",null,u(f.value),1),t("button",{class:"btn btn-outline-light btn-sm",type:"button",onClick:T,disabled:x.value}," Thá»­ láº¡i ",8,kt)])):Z("",!0),x.value?(r(),d("section",Ct,Nt)):l.value.length===0?(r(),d("section",Tt,[Et,Gt,Dt,q(o,{class:"btn btn-success",to:"/danh-sach-san-pham"},{default:A(()=>[V(" Xem sáº£n pháº©m ")]),_:1})])):(r(),d("section",Rt,[t("div",Zt,[t("article",qt,[t("div",At,[t("div",Vt,[t("table",Ht,[t("thead",jt,[t("tr",null,[t("th",Pt,[t("input",{class:"form-check-input",type:"checkbox",checked:g.value,onChange:et},null,40,Bt)]),Lt,Qt,Ft,Ut,Wt])]),t("tbody",null,[(r(!0),d(it,null,ut(l.value,n=>(r(),d("tr",{key:n.id,class:F({"table-active":n.selected})},[t("td",Ot,[t("input",{class:"form-check-input",type:"checkbox",checked:n.selected,onChange:i=>st(n,i)},null,40,Xt)]),t("td",null,[t("div",zt,[t("img",{src:n.image||N,class:"thumb",alt:"",onError:i=>tt(i,n)},null,40,Jt),t("div",Yt,[t("h6",Kt,u(n.name),1),t("p",$t,u(n.category||"Danh má»¥c khÃ¡c"),1)])])]),t("td",te,u(I(n.price)),1),t("td",ee,[t("div",se,[t("button",{type:"button",class:"btn btn-sm btn-light",onClick:i=>L(n,-1),disabled:n.quantity<=1||v.value},"âˆ’",8,ne),t("input",{type:"number",min:"1",value:n.quantity,onInput:i=>z(n,i.target.value),disabled:v.value},null,40,oe),t("button",{type:"button",class:"btn btn-sm btn-light",onClick:i=>L(n,1),disabled:v.value},"ï¼‹",8,le)])]),t("td",ce,u(I(G(n))),1),t("td",ae,[q(o,{class:"btn btn-outline-success btn-sm mb-2 w-100",to:{name:"checkout",query:{product_id:n.id,quantity:n.quantity,from_cart:"1"}}},{default:A(()=>[V(" Thanh toÃ¡n ")]),_:2},1032,["to"]),t("button",{class:"btn btn-link btn-outline-danger text-danger p-0",onClick:i=>J(n),disabled:v.value},"XÃ³a",8,ie)])],2))),128))])])])])])]),t("div",ue,[t("aside",de,[t("div",re,[he,t("div",_e,[me,t("span",pe,u(I(S.value)),1)]),t("div",ge,[be,t("span",null,u(D.value>0?I(D.value):"Miá»…n phÃ­"),1)]),t("div",ve,[fe,t("span",null,"-"+u(I(B.value)),1)]),t("div",ye,[Ie,t("span",xe,u(I(X.value)),1)]),t("div",ke,[Ce,t("div",we,[dt(t("input",{"onUpdate:modelValue":s[0]||(s[0]=n=>w.value=n),type:"text",class:"form-control",placeholder:"Nháº­p mÃ£ (vÃ­ dá»¥: FREESHIP)"},null,512),[[rt,w.value,void 0,{trim:!0}]]),t("button",{class:"btn btn-outline-success",type:"button",onClick:K},"Ãp dá»¥ng")]),h.value?(r(),d("p",{key:0,class:F(["small mt-2",p.value?"text-success":"text-danger"])},u(h.value),3)):Z("",!0)]),t("div",Me,[t("button",{class:"btn btn-success btn-lg",type:"button",onClick:$,disabled:!U.value||l.value.length===0}," Tiáº¿p tá»¥c thanh toÃ¡n ",8,Se),q(o,{to:"/danh-sach-san-pham",class:"btn btn-outline-secondary"},{default:A(()=>[V(" Tiáº¿p tá»¥c mua sáº¯m ")]),_:1})])])])])]))])}}},Ee=ot(Ne,[["__scopeId","data-v-2c500b57"]]);export{Ee as default};
